<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Confippet | Electrode</title>
  <meta name="viewport" content="width=device-width">
  <meta property="og:title" content="Confippet | Electrode">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://electrode-io.github.io//docs/confippet.html">
  <meta property="og:image" content="https://electrode-io.github.io/img/logo_og.png">
  <meta property="og:description" content="Universal React and Node Applications simplified, performant, and reusable.">
  <meta property="fb:app_id" content="623268441017527">


  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Electrode" href="https://electrode-io.github.io/feed.xml">

  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/electrode-docs.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700" type="text/css">

  <script src="//use.typekit.net/vqa1hcx.js"></script>
  <script>try{Typekit.load();}catch(e){}</script>

  <!--[if lte IE 8]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/es5-shim.min.js"></script>
  <script src="/js/es5-sham.min.js"></script>
  <![endif]-->

</head>
<body>

  <div class="container">

    <div class="nav-main">
      <div class="wrap">
        <a class="nav-home" href="/index.html">
          <img class="nav-logo" src="/img/electrode-02.png" width="45" height="45" style="margin-bottom: 5px;">
          electrode
        </a>

        <ul class="nav-site nav-site-internal">
          <li><a href="/docs/what_is_electrode.html" class="active">docs</a></li>
          <!--<li><a href="/support.html">Support</a></li>-->
        </ul>
        <ul class="nav-site nav-site-external">
          <li><a href="https://github.com/electrode-io">GitHub</a></li>
          <li><a href="http://walmartlabs.com"><span class="logo-orange">@</span><span class="logo-blue">Walmart</span><span class="logo-orange">Labs</span></a></li>
        </ul>
      </div>
    </div>

    

    <section class="content wrap documentationContent">
  <div class="nav-docs">
  
    <div class="nav-docs-section">
      <h3>Overview</h3>
      
        <ul>
          


  
  
  
  
    <li>
    

    <a href="/docs/what_is_electrode.html"> &nbsp; What is Electrode?</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/why_use_electrode.html"> &nbsp; Why Use Electrode?</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/requirements.html"> &nbsp; Requirements</a>

    
    </li>
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  


        </ul>
      
    </div>
  
    <div class="nav-docs-section">
      <h3>Getting Started</h3>
      
        
          <h5>Quick Start</h5>
          <ul>
            


  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  
    <li>
    

    <a href="/docs/get_started.html"> &nbsp; Get Started</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/build_component.html"> &nbsp; Build Component</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/deploy_app.html"> &nbsp; Deploy Your App</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/whats_inside.html"> &nbsp; What's Inside</a>

    
    </li>
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  


          </ul>
        
          <h5>Intermediate</h5>
          <ul>
            


  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  
    <li>
    

    <a href="/docs/create_reusable_component.html"> &nbsp; Create a Reusable Component</a>

    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/low_level_components.html"> &nbsp; Low-Level Components</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/component_helpers.html"> &nbsp; Component Helpers</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/develop_styles.html"> &nbsp; Develop Styles</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/high_level_component.html"> &nbsp; Develop Main Component</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/test_components.html"> &nbsp; Test Components</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/add_examples.html"> &nbsp; Add Examples</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/build_and_demo.html"> &nbsp; Build and Demo</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/generate_docs.html"> &nbsp; Generate Docs</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/build_server_plugin.html"> &nbsp; Build a Server Plugin</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/add_routes.html"> &nbsp; Add Routes</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/server_config.html"> &nbsp; Server Config</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/more_deployments.html"> &nbsp; More Deployments</a>

    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/docker.html"> &nbsp; Docker</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/kubernetes.html"> &nbsp; Kubernetes</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  


          </ul>
        
          <h5>Advanced</h5>
          <ul>
            


  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  
    <li>
    

    <a href="/docs/stand_alone_modules.html"> &nbsp; Stand Alone Modules</a>

    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/confippet.html" class="active"> &nbsp; Confippet</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/above_fold_rendering.html"> &nbsp; Above The Fold Rendering</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/server_side_render_cache.html"> &nbsp; Server Side Render Caching + Profiling</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/stateless_csrf_validation.html"> &nbsp; Stateless CSRF Validation</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/redux_router_engine.html"> &nbsp; Redux Router Engine</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/electrode_tools.html"> &nbsp; Powerful Electrode Tools</a>

    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/electrify.html"> &nbsp; Electrify</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/electrode_explorer.html"> &nbsp; Electrode Explorer</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    
      <ul><li>
    

    <a href="/docs/bundle-analyzer.html"> &nbsp; Bundle Analyzer</a>

    
      </li></ul>
    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/electrode_boilerplate.html"> &nbsp; Electrode Boilerplate</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/community.html"> &nbsp; Community</a>

    
    </li>
  

  
  
  
  

  
  
  
  

  
  
  
  


          </ul>
        
      
    </div>
  
    <div class="nav-docs-section">
      <h3>Resources</h3>
      
        <ul>
          


  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  
    <li>
    

    <a href="/docs/further_reading.html"> &nbsp; Further Reading</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/glossary.html"> &nbsp; Glossary</a>

    
    </li>
  

  
  
  
  
    <li>
    

    <a href="/docs/faq.html"> &nbsp; FAQs</a>

    
    </li>
  


        </ul>
      
    </div>
  


  <!-- Tips Nav -->
  <!-- 
    <div class="nav-docs-section">
      <h3>Tips</h3>
      <ul>
        
          <li>
            <a href="/tips/introduction.html">Introduction</a>
          </li>
        
      </ul>
    </div>
   -->

  <!-- Contributing Nav -->
  <!-- 
    <div class="nav-docs-section">
      <h3>Contributing</h3>
      <ul>
        
          <li>
            <a href="/contributing/design-principles.html">Design Principles</a>
          </li>
        
      </ul>
    </div>
   -->
</div>


  <div class="inner-content">
    <a class="edit-page-link" href="https://github.com/electrode-io/electrode-io.github.io/tree/develop/_docs/04.1.1-confippet.markdown" target="_blank">Edit on GitHub</a>
    <h1>
      Confippet
    </h1>
    <div class="subHeader"></div>

    <p><a href="https://github.com/electrode-io/electrode-confippet">Confippet</a> is a versatile, flexible utility for managing configurations of
Node.js applications. It&#39;s simple to get started, and can be customized and
extended to meet the needs of your app</p>

<p><a href="https://github.com/electrode-io/electrode-confippet">Confippet</a> can be used as a standalone module in your favorite Node.js web server framework or application.</p>
<h3><a class="anchor" name="features"></a>Features <a class="hash-link" href="#features">#</a></h3>
<ul>
<li><strong>Simple</strong> - Confippet&#39;s <code>presetConfig</code> automatically composes a single config
object from multiple files. For most applications, no further customization is
necessary.</li>
<li><strong>Flexible</strong> - Supports JSON, YAML, and JavaScript config files.</li>
<li><strong>Powerful</strong> - Handles complex multi-instance enterprise deployments.</li>
<li><strong>Platform Agnostic</strong> - This module is platform agnostic and can be plugged-in Electrode, Express.js and Hapi.js applications or any Node.js application.</li>
</ul>
<h2><a class="anchor" name="module-electrode-confippet"></a>Module: <a href="https://github.com/electrode-io/electrode-confippet">electrode-confippet</a> <a class="hash-link" href="#module-electrode-confippet">#</a></h2><h3><a class="anchor" name="install-via-npm"></a>Install via <code>npm</code> <a class="hash-link" href="#install-via-npm">#</a></h3><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>npm install --save electrode-confippet
</code></pre></div><h3><a class="anchor" name="example-applications"></a>Example Applications <a class="hash-link" href="#example-applications">#</a></h3>
<ul>
<li><p><a href="https://github.com/electrode-io/electrode-boilerplate-universal-react-node#electrode-confippet">Electrode Boilerplate</a></p></li>
<li><p><a href="https://github.com/docs-code-examples-electrode-io/express-example-with-standalone-electrode-modules#electrode-confippet">Express Example with Standalone Modules</a></p></li>
<li><p><a href="https://github.com/docs-code-examples-electrode-io/hapijs-example-with-standalone-electrode-modules#electrode-confippet">Hapi Example with Standalone Modules</a></p></li>
</ul>
<h2><a class="anchor" name="usage"></a>Usage <a class="hash-link" href="#usage">#</a></h2>
<ul>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#config-composition">Config Composition</a></li>
<li><a href="#environment-variables">Environment Variables</a></li>
<li><a href="#using-templates">Using Templates</a></li>
<li><a href="#usage-in-node-modules">Usage in Node Modules</a></li>
<li><a href="#customization">Customization</a></li>
</ul>
<h3><a class="anchor" name="getting-started"></a>Getting Started <a class="hash-link" href="#getting-started">#</a></h3>
<p>Let&#39;s say that in our application we need to access a database that is running 
locally in our development environment but is running on a specific hostname 
while running in our production environment. We would like to be able to get 
the correct hostname in our code, without too much effort, based on the current environment.</p>

<p>Confippet can help us with this. All we have to do is to create a few config files like the following: </p>

<p><code>config/default.json</code></p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;db&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
      <span class="nt">&quot;port&quot;</span><span class="p">:</span> <span class="mi">5432</span><span class="p">,</span>
      <span class="nt">&quot;database&quot;</span><span class="p">:</span> <span class="s2">&quot;clients&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>config/development.json</code></p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;db&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;dev-db-server&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>config/production.json</code></p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;db&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;prod-db-server&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The above configs can be used in the app using the following: </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;electrode-confippet&quot;</span><span class="p">).</span><span class="nx">config</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;settings.db&quot;</span><span class="p">);</span>
</code></pre></div>
<p>In this example, <code>default.json</code> will be loaded in all environments, whereas
<code>production.json</code> will be loaded only when the <code>NODE_ENV</code> environment variable
is set to <code>production</code>. In that case, the value of <code>host</code> in the <code>db</code> object
will be overwritten by the value in <code>production.json</code>.</p>
<h3><a class="anchor" name="config-composition"></a>Config Composition <a class="hash-link" href="#config-composition">#</a></h3>
<p>Confippet&#39;s <code>presetConfig</code> composes together files in the <code>config/</code> directory,
in the following order:</p>

<ol>
<li><code>default.EXT</code></li>
<li><code>default-{instance}.EXT</code></li>
<li><code>{deployment}.EXT</code></li>
<li><code>{deployment}-{instance}.EXT</code></li>
<li><code>{short_hostname}.EXT</code></li>
<li><code>{short_hostname}-{instance}.EXT</code></li>
<li><code>{short_hostname}-{deployment}.EXT</code></li>
<li><code>{short_hostname}-{deployment}-{instance}.EXT</code></li>
<li><code>{full_hostname}.EXT</code></li>
<li><code>{full_hostname}-{instance}.EXT</code></li>
<li><code>{full_hostname}-{deployment}.EXT</code></li>
<li><code>{full_hostname}-{deployment}-{instance}.EXT</code></li>
<li><code>local.EXT</code></li>
<li><code>local-{instance}.EXT</code></li>
<li><code>local-{deployment}.EXT</code></li>
<li><code>local-{deployment}-{instance}.EXT</code></li>
</ol>

<p>Where:</p>

<ul>
<li><code>EXT</code> can be any of <code>[&quot;json&quot;, &quot;yaml&quot;, &quot;js&quot;]</code>. Confippet will load all of them,
in that order. Each time it finds a config file, the values in that file will
be loaded and merged into the config store. So <code>js</code> overrides <code>yaml</code>, which
overrides <code>json</code>. You can add handlers for other file types and change their
loading orderâ€”see <a href="https://github.com/electrode-io/electrode-confippet/blob/master/compose.md">composeConfig</a> for further details.</li>
<li><code>{instance}</code> is your app&#39;s instance string in multi-instance deployments
(specified by the <code>NODE_APP_INSTANCE</code> environment variable).</li>
<li><code>{short_hostname}</code> is your server name up to the first dot.</li>
<li><code>{full_hostname}</code> is your whole server name.</li>
<li><code>{deployment}</code> is your deployment environment (specified by the <code>NODE_ENV</code>
environment variable).</li>
</ul>

<p>Overridden values are handled as follows:</p>

<ul>
<li>Objects are merged.</li>
<li>Primitive values (string, boolean, number) are replaced.</li>
<li><strong>Arrays are replaced</strong>, unless the key starts with <code>+</code> <em>and</em> both the source
and the target are arrays. In that case, the two arrays are joined together
using Lodash&#39;s <code>_.union</code> method.</li>
</ul>

<p>After Confippet loads all available configuration files, it will look for
override JSON strings from the <code>NODE_CONFIG</code> and <code>CONFIPPET*</code> environment
variables. See the next section for details.</p>
<h3><a class="anchor" name="environment-variables"></a>Environment Variables <a class="hash-link" href="#environment-variables">#</a></h3>
<p>Confippet reads the following environment variables when composing a config
store:</p>

<ul>
<li><code>AUTO_LOAD_CONFIG_OFF</code> - If this is set, then Confippet will <strong>not</strong>
automatically load any configuration into the preset <code>config</code> store.
<code>Confippet.config</code> will be an empty store. This enables you to customize the
config structure before loading.</li>
<li><code>NODE_CONFIG_DIR</code> - Set the directory to search for config files. By default,
Confippet looks in the <code>config</code> directory for config files.</li>
<li><code>NODE_ENV</code> - By default, Confippet loads <code>development</code> config files after
loading <code>default</code>. Set this environment variable to change to a different
deployment, such as <code>production</code>.</li>
<li><code>NODE_APP_INSTANCE</code> - If your app is deployed to multiple instances, you can
set this to load instance-specific configurations.</li>
<li><code>AUTO_LOAD_CONFIG_PROCESS_OFF</code> - By default, after composing the config from
all sources, Confippet will use <a href="https://github.com/electrode-io/electrode-confippet/blob/master/templates.md">processConfig</a> to process
<a href="#using-templates">templates</a>. You can set this environment variable to
disable template processing.</li>
<li><code>NODE_CONFIG</code> - You can set this to a valid JSON string and Confippet will
parse it to override the configuration.</li>
<li><code>CONFIPPET*</code> - Any environment variables that starts with <code>CONFIPPET</code> will be
parsed as JSON strings to override the configuration.</li>
</ul>
<h3><a class="anchor" name="using-templates"></a>Using Templates <a class="hash-link" href="#using-templates">#</a></h3>
<p>Values in your config files can be templates, which will be resolved with
a preset context. See <a href="https://github.com/electrode-io/electrode-confippet/blob/master/templates.md">processConfig</a> for more information about how to use
config value templates.</p>
<h3><a class="anchor" name="usage-in-node-modules"></a>Usage in Node Modules <a class="hash-link" href="#usage-in-node-modules">#</a></h3>
<p>If you have a Node.js module that has its own configurations based on
environment variables, like <code>NODE_ENV</code>, you can use Confippet to load config
files for your module.</p>

<p>The example below will use the <a href="https://github.com/electrode-io/electrode-confippet/blob/master/lib/default-compose-opts.js">default compose options</a> to compose
configurations from the directory <code>config</code> under the script&#39;s directory
(<code>__dirname</code>).</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">Confippet</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;electrode-confippet&quot;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">dirs</span><span class="o">:</span> <span class="p">[</span><span class="nx">Path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">)],</span>
  <span class="nx">warnMissing</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">context</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">deployment</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kr">const</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="nx">Confippet</span><span class="p">.</span><span class="nx">store</span><span class="p">();</span>
<span class="nx">defaults</span><span class="p">.</span><span class="nx">_$</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
</code></pre></div><h3><a class="anchor" name="customization"></a>Customization <a class="hash-link" href="#customization">#</a></h3>
<p>The <a href="https://github.com/electrode-io/electrode-confippet/blob/master/compose.md">composeConfig</a> feature supports a fully customizable and extendable config
structure. Even Confippet&#39;s own preset config structure can be extended, since
it&#39;s composed using the same feature.</p>

<p>If you want to use the preset config, but add an extension handler or insert
a source, you can turn off auto loading, and load it yourself with your own
options.</p>

<blockquote>
<p><strong>NOTE:</strong> This has to happen before any other file accesses
<code>Confippet.config</code>. You should do this in your startup <code>index.js</code> file.</p>
</blockquote>

<p>For example:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">AUTO_LOAD_CONFIG_OFF</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">JSON5</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;json5&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;fs&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">Confippet</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;electrode-confippet&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">Confippet</span><span class="p">.</span><span class="nx">config</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">extHandlers</span> <span class="o">=</span> <span class="nx">Confippet</span><span class="p">.</span><span class="nx">extHandlers</span><span class="p">;</span>
<span class="nx">extHandlers</span><span class="p">.</span><span class="nx">json5</span> <span class="o">=</span> <span class="p">(</span><span class="nx">fullF</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">JSON5</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">fullF</span><span class="p">,</span> <span class="s2">&quot;utf8&quot;</span><span class="p">));</span>

<span class="nx">Confippet</span><span class="p">.</span><span class="nx">presetConfig</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">extSearch</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;json5&quot;</span><span class="p">,</span> <span class="s2">&quot;yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;js&quot;</span><span class="p">],</span>
  <span class="nx">extHandlers</span><span class="p">,</span>
  <span class="nx">providers</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">customConfig</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="nx">order</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="nx">Confippet</span><span class="p">.</span><span class="nx">providerTypes</span><span class="p">.</span><span class="nx">required</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>The above compose option adds a new provider that looks for a file named by the
environment variable <code>CUSTOM_CONFIG_SOURCE</code> and will be loaded after all default
sources are loaded (controlled by <code>order</code>).</p>

<p>It also adds a new extension handler, <code>json5</code>, to be loaded after <code>json</code>.</p>

<p>To further understand the <code>_$</code> and the <code>compose</code> options, please see the
documentation for <a href="https://github.com/electrode-io/electrode-confippet/blob/master/store.md">store</a>, <a href="https://github.com/electrode-io/electrode-confippet/blob/master/compose.md">composeConfig</a>, and <a href="https://github.com/electrode-io/electrode-confippet/blob/master/templates.md">processConfig</a>.</p>


    








<div class="docs-prevnext">
  
    <a class="docs-prev" href="/docs/stand_alone_modules.html">&larr; Prev</a>
  
  
    <a class="docs-next" href="/docs/above_fold_rendering.html">Next &rarr;</a>
  
</div>


  </div>
</section>


    <footer class="wrap">
      <div class="left">
        <a href="https://github.com/orgs/electrode-io/people" target="_blank">Acknowledgements</a>
      </div>
      <div class="right">
        &copy; 2016 <a href="http://walmartlabs.com" target="_blank">WalmartLabs</a><br>
        Apache-2.0 license.
      </div>
    </footer>
  </div>
  <div id="fb-root"></div>

  <!--
    TODO: analytics js, etc.
  -->
</body>
</html>
